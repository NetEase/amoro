
/*
  * Licensed to the Apache Software Foundation (ASF) under one
  * or more contributor license agreements.  See the NOTICE file
  * distributed with this work for additional information
  * regarding copyright ownership.  The ASF licenses this file
  * to you under the Apache License, Version 2.0 (the
  * "License"); you may not use this file except in compliance
  * with the License.  You may obtain a copy of the License at
  *
  *     http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */

import{v as he,V as ve,L as ye,C as P,D as L,O as A,a7 as De,a3 as Ce,r as Ke,o as l,e as d,z as T,u as f,h as i,y as c,c as p,g as b,F as J,k as Q,a5 as B,M as oe,a8 as K,G as He,I as qe,E as ze,a9 as Xe,a1 as _e,H as xe,q as le,aa as je,ab as Ve,x as be,K as We,_ as fe,ac as Ze,ad as Je}from"./index-VAF7-_iX.js";/* empty css              *//* empty css              */import{g as Qe}from"./table.service-b5bGQVd9.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g as Ye,c as ea,s as aa,d as ta,a as oa}from"./setting.services-dZQpWHZu.js";import{_ as me,g as la}from"./optimize.service-ZvRPjFOW.js";import{u as sa}from"./usePlaceholder-tGpP4ulb.js";const na={class:"detail-wrap"},ia={class:"detail-content-wrap"},ra={class:"content-wrap"},ua={class:"header"},ca={key:1,class:"config-value"},pa={key:1},da={key:1},ga={key:1},fa={class:"header"},ma={key:1,class:"config-value"},ha={key:1,class:"config-value"},va={key:1,class:"config-value"},ya={key:3},Ca=["onClick"],_a={class:"header"},ba={key:1,class:"config-value"},ka={key:1,class:"config-value"},Ea={key:1,class:"config-value"},Ia={key:6},wa=["onClick","title"],Na={key:1,class:"config-value"},Ma={key:1,class:"config-value"},Sa={class:"header"},$a={class:"header"},Ra={key:0,class:"footer-btn"},Pa={key:1,class:"footer-btn"},Ta=he({__name:"Detail",props:{isEdit:{type:Boolean}},emits:["updateEdit","updateCatalogs"],setup(se,{emit:H}){const N={"Internal Catalog":"Internal Catalog","External Catalog":"External Catalog"},Y=se,y=H,{t:m}=ve(),M=ye(),$=P(sa()),x=L(""),u=A(()=>Y.isEdit),j=A(()=>"/ams/v1/files"),I=A(()=>{var t;const a=(((t=M.query)==null?void 0:t.catalogname)||"").toString();return decodeURIComponent(a)==="new catalog"}),U=A(()=>e.catalog.type==="hive");A(()=>e.catalog.type==="ams");const O=L(!1),F=L(),D=L(),q=L(),h={MIXED_HIVE:"MIXED_HIVE",ICEBERG:"ICEBERG",MIXED_ICEBERG:"MIXED_ICEBERG",PAIMON:"PAIMON"},g={[h.ICEBERG]:"Iceberg",[h.MIXED_HIVE]:"Mixed Hive",[h.MIXED_ICEBERG]:"Mixed Iceberg",[h.PAIMON]:"Paimon"},C={ams:[h.MIXED_ICEBERG,h.ICEBERG],hive:[h.MIXED_HIVE,h.MIXED_ICEBERG,h.ICEBERG,h.PAIMON],hadoop:[h.MIXED_ICEBERG,h.ICEBERG,h.PAIMON],glue:[h.MIXED_ICEBERG,h.ICEBERG],custom:[h.MIXED_ICEBERG,h.ICEBERG]},_={"hadoop.core.site":"core-site.xml","hadoop.hdfs.site":"hdfs-site.xml","hive.site":"hive-site.xml"},R={storageConfig:{"hadoop.core.site":"","hadoop.hdfs.site":""},authConfig:{"auth.kerberos.keytab":"","auth.kerberos.krb5":""}},w=L([{label:N["Internal Catalog"],value:N["Internal Catalog"]},{label:N["External Catalog"],value:N["External Catalog"]}]),e=P({catalog:{name:"",type:"ams",typeshow:N["Internal Catalog"],optimizerGroup:void 0},tableFormat:"",storageConfig:{},authConfig:{},properties:{},tableProperties:{},storageConfigArray:[],authConfigArray:[]}),V=P([{label:"SIMPLE",value:"SIMPLE"},{label:"KERBEROS",value:"KERBEROS"}]),z=P([{label:"AK/SK",value:"AK/SK"},{label:"CUSTOM",value:"CUSTOM"}]),ne={"hadoop.core.site":"Hadoop core-site","hadoop.hdfs.site":"Hadoop hdfs-site","hive.site":"Hadoop hive-site"},ke={"auth.kerberos.keytab":"Kerberos Keytab","auth.kerberos.krb5":"Kerberos Krb5"},ee={ams:["warehouse"],hadoop:["warehouse"],custom:["catalog-impl"],glue:["warehouse","lock-impl","lock.table"],PAIMON:["warehouse"]};De(()=>M.query,a=>{a&&Ee()},{immediate:!0,deep:!0});const W=P([]),ie=L([]);function Ee(){ae()}const Ie=async()=>{const t=(await la()||[]).map(s=>({lable:s.resourceGroup.name,value:s.resourceGroup.name}));ie.value=t};async function we(){(await Ye()||[]).forEach(t=>{t.value!=="ams"&&W.push({label:t.display,value:t.value})}),re()}function re(){x.value=(W.find(a=>a.value===e.catalog.type)||{}).label}async function ae(){try{O.value=!0;const{catalogname:a,type:t}=M.query;if(!a)return;if(I.value){e.catalog.name="",e.catalog.type=t||"ams",e.catalog.optimizerGroup=void 0,e.tableFormat=h.MIXED_ICEBERG,e.authConfig={...R.authConfig},e.storageConfig={...R.storageConfig};const n=ee[e.catalog.type]||[];e.properties={},n.forEach(v=>{e.properties[v]=""}),e.tableProperties={},e.storageConfigArray.length=0,e.authConfigArray.length=0}else{const n=await oa(a);if(!n)return;const{name:v,type:k,tableFormatList:E,storageConfig:G,authConfig:X,properties:te,tableProperties:o,optimizerGroup:S}=n;e.catalog.name=v,e.catalog.type=k,e.catalog.optimizerGroup=S,e.tableFormat=E.join(""),e.authConfig=X,e.storageConfig=G,e.properties=te||{},e.tableProperties=o||{},e.storageConfigArray.length=0,e.authConfigArray.length=0,re()}e.catalog.typeshow=e.catalog.type==="ams"?N["Internal Catalog"]:N["External Catalog"];const{storageConfig:s,authConfig:r}=e;Object.keys(s).forEach(n=>{var k,E,G;const v=["hadoop.core.site","hadoop.hdfs.site"];if(U.value&&v.push("hive.site"),v.includes(n)){const X={key:n,label:ne[n],value:(k=s[n])==null?void 0:k.fileName,fileName:(E=s[n])==null?void 0:E.fileName,fileUrl:(G=s[n])==null?void 0:G.fileUrl,fileId:"",fileList:[],uploadLoading:!1,isSuccess:!1};e.storageConfigArray.push(X)}}),Object.keys(r).forEach(n=>{var v,k,E;if(["auth.kerberos.keytab","auth.kerberos.krb5"].includes(n)){const G={key:n,label:ke[n],value:(v=r[n])==null?void 0:v.fileName,fileName:(k=r[n])==null?void 0:k.fileName,fileUrl:(E=r[n])==null?void 0:E.fileUrl,fileId:"",fileList:[],uploadLoading:!1,isSuccess:!1};e.authConfigArray.push(G)}})}catch{}finally{O.value=!1}}const Ne=a=>{a===N["Internal Catalog"]?e.catalog.type="ams":e.catalog.type=W[0].value,pe()},ue=A(()=>{const a=e.catalog.type;return C[a]||[]});async function ce(){const a=await D.value.getPropertiesWithoputValidation(),t=ee[e.catalog.type]||[];t.forEach(r=>{r&&!a[r]&&(a[r]="")});const s=ee[e.tableFormat]||[];s.forEach(r=>{r&&!a[r]&&(a[r]="")});for(const r in a)!a[r]&&!t.includes(r)&&!s.includes(r)&&delete a[r];e.properties=a}const Me=P([{label:"S3",value:"S3"}]),Se=P([{label:"Hadoop",value:"Hadoop"}]),$e=P([{label:"Hadoop",value:"Hadoop"},{label:"S3",value:"S3"}]),Re=A(()=>{const a=e.catalog.type;return a==="ams"||a==="custom"?$e:a==="glue"?Me:a==="hive"||a==="hadoop"?Se:null}),Pe=A(()=>{const a=e.storageConfig["storage.type"];return a==="Hadoop"?V:a==="S3"?z:null});async function pe(){if(e.tableFormat=ue.value[0],!I.value)return;const a=e.storageConfigArray.findIndex(t=>t.key==="hive.site");if(U.value){if(a>-1)return;e.storageConfigArray.push({key:"hive.site",label:ne["hive.site"],value:"",fileName:"",fileUrl:"",fileId:"",fileList:[],uploadLoading:!1,isSuccess:!1}),e.storageConfig["hive.site"]=""}else a>-1&&(e.storageConfigArray.splice(a,1),delete e.storageConfig["hive.site"]);await ce()}async function Te(){await ce()}function Ue(){y("updateEdit",!0)}async function Ge(){if(await ea(e.catalog.name)){Fe();return}oe.confirm({title:m("cannotDeleteModalTitle"),content:m("cannotDeleteModalContent"),wrapClassName:"not-delete-modal"})}async function Le(a,t){return t?/^[a-zA-Z][\w-]*$/.test(t)?Promise.resolve():Promise.reject(new Error(m("invalidInput"))):Promise.reject(new Error(m("inputPlaceholder")))}function Oe(){const{storageConfig:a,authConfig:t,storageConfigArray:s,authConfigArray:r}=e;Object.keys(t).forEach(n=>{if(["auth.kerberos.keytab","auth.kerberos.krb5"].includes(n)){const v=(r.find(k=>k.key===n)||{}).fileId;t[n]=v}}),Object.keys(a).forEach(n=>{if(["hadoop.core.site","hadoop.hdfs.site","hive.site"].includes(n)){const v=(s.find(k=>k.key===n)||{}).fileId;a[n]=v}})}function Ae(){F.value.validateFields().then(async()=>{const{catalog:a,tableFormat:t,storageConfig:s,authConfig:r}=e,n=await D.value.getProperties(),v=await q.value.getProperties();if(!n||!v)return;O.value=!0;const{typeshow:k,...E}=a;Oe(),await aa({isCreate:I.value,...E,tableFormatList:[t],storageConfig:s,authConfig:r,properties:n,tableProperties:v}).then(()=>{K.success(`${m("save")} ${m("success")}`),y("updateEdit",!1,{catalogName:a.name,catalogType:a.type}),ae(),F.value.resetFields()}).catch(()=>{K.error(`${m("save")} ${m("failed")}`)}).finally(()=>{O.value=!1})}).catch(()=>{})}function Be(){F.value.resetFields(),y("updateEdit",!1),ae()}async function Fe(){oe.confirm({title:m("deleteCatalogModalTitle"),onOk:async()=>{await ta(e.catalog.name),K.success(`${m("remove")} ${m("success")}`),y("updateEdit",!1,{})}})}function de(a,t,s){try{if(a.file.status==="uploading"?t.uploadLoading=!0:t.uploadLoading=!1,a.file.status==="done"){const{code:r}=a.file.response;if(r!==200){const{message:k}=a.file.response;throw new Error(k)}const{url:n,id:v}=a.file.response.result;t.isSuccess=!0,t.fileName=s==="STORAGE"?_[t.key]:a.file.name,t.fileUrl=n,t.fileId=v,K.success(`${a.file.name} ${m("uploaded")} ${m("success")}`)}else a.file.status==="error"&&(t.isSuccess=!1,K.error(`${a.file.name} ${m("uploaded")} ${m("failed")}`))}catch(r){K.error(r.message)}}function ge(a){a&&window.open(a)}return Ce(()=>{we(),Ie()}),(a,t)=>{const s=He,r=qe,n=ze,v=je,k=Xe,E=_e,G=Ve,X=xe,te=Ke("u-loading");return l(),d("div",na,[T("div",ia,[T("div",ra,[f(X,{ref_key:"formRef",ref:F,model:e,class:"catalog-form"},{default:i(()=>[f(s,null,{default:i(()=>[T("p",ua,c(a.$t("basic")),1)]),_:1}),f(s,{label:a.$t("name"),name:["catalog","name"],rules:[{required:u.value&&I.value,validator:Le}]},{default:i(()=>[u.value&&I.value?(l(),p(r,{key:0,value:e.catalog.name,"onUpdate:value":t[0]||(t[0]=o=>e.catalog.name=o)},null,8,["value"])):(l(),d("span",ca,c(e.catalog.name),1))]),_:1},8,["label","rules"]),f(s,{label:a.$t("type"),name:["catalog","typeshow"]},{default:i(()=>[u.value&&I.value?(l(),p(n,{key:0,value:e.catalog.typeshow,"onUpdate:value":t[1]||(t[1]=o=>e.catalog.typeshow=o),options:w.value,placeholder:$.selectPh,onChange:Ne},null,8,["value","options","placeholder"])):(l(),d("span",pa,c(e.catalog.typeshow),1))]),_:1},8,["label"]),e.catalog.typeshow===N["External Catalog"]?(l(),p(s,{key:0,label:a.$t("metastore"),name:["catalog","type"],rules:[{required:u.value&&I.value}]},{default:i(()=>[u.value&&I.value?(l(),p(n,{key:0,value:e.catalog.type,"onUpdate:value":t[2]||(t[2]=o=>e.catalog.type=o),options:W,placeholder:$.selectPh,onChange:pe},null,8,["value","options","placeholder"])):(l(),d("span",da,c(x.value),1))]),_:1},8,["label","rules"])):b("",!0),f(s,{label:a.$t("tableFormat"),name:["tableFormat"],rules:[{required:u.value&&I.value}]},{default:i(()=>[f(k,{disabled:!u.value||!I.value,value:e.tableFormat,"onUpdate:value":t[3]||(t[3]=o=>e.tableFormat=o),name:"radioGroup",onChange:Te},{default:i(()=>[(l(!0),d(J,null,Q(ue.value,o=>(l(),p(v,{key:o,value:o},{default:i(()=>[B(c(g[o]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["disabled","value"])]),_:1},8,["label","rules"]),f(s,{label:a.$t("optimizerGroup"),name:["catalog","optimizerGroup"],rules:[{required:u.value}]},{default:i(()=>[u.value?(l(),p(n,{key:0,value:e.catalog.optimizerGroup,"onUpdate:value":t[4]||(t[4]=o=>e.catalog.optimizerGroup=o),options:ie.value,placeholder:$.selectPh},null,8,["value","options","placeholder"])):(l(),d("span",ga,c(e.catalog.optimizerGroup),1))]),_:1},8,["label","rules"]),f(s,null,{default:i(()=>[T("p",fa,c(a.$t("storageConfigName")),1)]),_:1}),f(s,{label:"Type",name:["storageConfig","storage.type"],rules:[{required:u.value}]},{default:i(()=>[u.value?(l(),p(n,{key:0,value:e.storageConfig["storage.type"],"onUpdate:value":t[5]||(t[5]=o=>e.storageConfig["storage.type"]=o),placeholder:$.selectPh,options:Re.value},null,8,["value","placeholder","options"])):(l(),d("span",ma,c(e.storageConfig["storage.type"]),1))]),_:1},8,["name","rules"]),e.storageConfig["storage.type"]==="S3"?(l(),p(s,{key:1,label:"Endpoint",name:["storageConfig","storage.s3.endpoint"],rules:[{required:!1}]},{default:i(()=>[u.value?(l(),p(r,{key:0,value:e.storageConfig["storage.s3.endpoint"],"onUpdate:value":t[6]||(t[6]=o=>e.storageConfig["storage.s3.endpoint"]=o)},null,8,["value"])):(l(),d("span",ha,c(e.storageConfig["storage.s3.endpoint"]),1))]),_:1},8,["name"])):b("",!0),e.storageConfig["storage.type"]==="S3"?(l(),p(s,{key:2,label:"Region",name:["storageConfig","storage.s3.region"],rules:[{required:!1}]},{default:i(()=>[u.value?(l(),p(r,{key:0,value:e.storageConfig["storage.s3.region"],"onUpdate:value":t[7]||(t[7]=o=>e.storageConfig["storage.s3.region"]=o)},null,8,["value"])):(l(),d("span",va,c(e.storageConfig["storage.s3.region"]),1))]),_:1},8,["name"])):b("",!0),e.storageConfig["storage.type"]==="Hadoop"?(l(),d("div",ya,[(l(!0),d(J,null,Q(e.storageConfigArray,o=>(l(),p(s,{key:o.label,label:o.label,class:"g-flex-ac"},{default:i(()=>[u.value?(l(),p(G,{key:0,"file-list":o.fileList,"onUpdate:fileList":S=>o.fileList=S,name:"file",accept:".xml",showUploadList:!1,action:j.value,disabled:o.uploadLoading,onChange:S=>de(S,o,"STORAGE")},{default:i(()=>[f(E,{type:"primary",ghost:"",loading:o.uploadLoading,class:"g-mr-12"},{default:i(()=>[B(c(a.$t("upload")),1)]),_:2},1032,["loading"])]),_:2},1032,["file-list","onUpdate:fileList","action","disabled","onChange"])):b("",!0),o.isSuccess||o.fileName?(l(),d("span",{key:1,class:le(["config-value",{"view-active":!!o.fileUrl}]),onClick:S=>ge(o.fileUrl)},c(o.fileName),11,Ca)):b("",!0)]),_:2},1032,["label"]))),128))])):b("",!0),f(s,null,{default:i(()=>[T("p",_a,c(a.$t("authenticationConfig")),1)]),_:1}),f(s,{label:"Type",name:["authConfig","auth.type"],rules:[{required:u.value}]},{default:i(()=>[u.value?(l(),p(n,{key:0,value:e.authConfig["auth.type"],"onUpdate:value":t[8]||(t[8]=o=>e.authConfig["auth.type"]=o),placeholder:$.selectPh,options:Pe.value},null,8,["value","placeholder","options"])):(l(),d("span",ba,c(e.authConfig["auth.type"]),1))]),_:1},8,["name","rules"]),e.authConfig["auth.type"]==="SIMPLE"?(l(),p(s,{key:4,label:"Hadoop Username",name:["authConfig","auth.simple.hadoop_username"],rules:[{required:u.value}]},{default:i(()=>[u.value?(l(),p(r,{key:0,value:e.authConfig["auth.simple.hadoop_username"],"onUpdate:value":t[9]||(t[9]=o=>e.authConfig["auth.simple.hadoop_username"]=o)},null,8,["value"])):(l(),d("span",ka,c(e.authConfig["auth.simple.hadoop_username"]),1))]),_:1},8,["name","rules"])):b("",!0),e.authConfig["auth.type"]==="KERBEROS"?(l(),p(s,{key:5,label:"Kerberos Principal",name:["authConfig","auth.kerberos.principal"],rules:[{required:u.value}]},{default:i(()=>[u.value?(l(),p(r,{key:0,value:e.authConfig["auth.kerberos.principal"],"onUpdate:value":t[10]||(t[10]=o=>e.authConfig["auth.kerberos.principal"]=o)},null,8,["value"])):(l(),d("span",Ea,c(e.authConfig["auth.kerberos.principal"]),1))]),_:1},8,["name","rules"])):b("",!0),e.authConfig["auth.type"]==="KERBEROS"?(l(),d("div",Ia,[(l(!0),d(J,null,Q(e.authConfigArray,o=>(l(),p(s,{key:o.label,label:o.label,class:"g-flex-ac"},{default:i(()=>[u.value?(l(),p(G,{key:0,"file-list":o.fileList,"onUpdate:fileList":S=>o.fileList=S,name:"file",accept:o.key==="auth.kerberos.keytab"?".keytab":".conf",showUploadList:!1,action:j.value,disabled:o.uploadLoading,onChange:S=>de(S,o)},{default:i(()=>[f(E,{type:"primary",ghost:"",loading:o.uploadLoading,class:"g-mr-12"},{default:i(()=>[B(c(a.$t("upload")),1)]),_:2},1032,["loading"])]),_:2},1032,["file-list","onUpdate:fileList","accept","action","disabled","onChange"])):b("",!0),o.isSuccess||o.fileName?(l(),d("span",{key:1,class:le(["config-value auth-filename",{"view-active":!!o.fileUrl}]),onClick:S=>ge(o.fileUrl),title:o.fileName},c(o.fileName),11,wa)):b("",!0)]),_:2},1032,["label"]))),128))])):b("",!0),e.authConfig["auth.type"]==="AK/SK"?(l(),p(s,{key:7,label:"Access Key",name:["authConfig","auth.ak_sk.access_key"],rules:[{required:u.value}]},{default:i(()=>[u.value?(l(),p(r,{key:0,value:e.authConfig["auth.ak_sk.access_key"],"onUpdate:value":t[11]||(t[11]=o=>e.authConfig["auth.ak_sk.access_key"]=o)},null,8,["value"])):(l(),d("span",Na,c(e.authConfig["auth.ak_sk.access_key"]),1))]),_:1},8,["name","rules"])):b("",!0),e.authConfig["auth.type"]==="AK/SK"?(l(),p(s,{key:8,label:"Secret Key",name:["authConfig","auth.ak_sk.secret_key"],rules:[{required:u.value}]},{default:i(()=>[u.value?(l(),p(r,{key:0,value:e.authConfig["auth.ak_sk.secret_key"],"onUpdate:value":t[12]||(t[12]=o=>e.authConfig["auth.ak_sk.secret_key"]=o)},null,8,["value"])):(l(),d("span",Ma,c(e.authConfig["auth.ak_sk.secret_key"]),1))]),_:1},8,["name","rules"])):b("",!0),f(s,null,{default:i(()=>[T("p",Sa,c(a.$t("properties")),1)]),_:1}),f(s,null,{default:i(()=>[f(me,{propertiesObj:e.properties,isEdit:u.value,ref_key:"propertiesRef",ref:D},null,8,["propertiesObj","isEdit"])]),_:1}),f(s,null,{default:i(()=>[T("p",$a,c(a.$t("tableProperties")),1)]),_:1}),f(s,null,{default:i(()=>[f(me,{propertiesObj:e.tableProperties,isEdit:u.value,ref_key:"tablePropertiesRef",ref:q},null,8,["propertiesObj","isEdit"])]),_:1})]),_:1},8,["model"])])]),u.value?(l(),d("div",Ra,[f(E,{type:"primary",onClick:Ae,class:"save-btn g-mr-12"},{default:i(()=>[B(c(a.$t("save")),1)]),_:1}),f(E,{onClick:Be},{default:i(()=>[B(c(a.$t("cancel")),1)]),_:1})])):b("",!0),u.value?b("",!0):(l(),d("div",Pa,[f(E,{type:"primary",onClick:Ue,class:"edit-btn g-mr-12"},{default:i(()=>[B(c(a.$t("edit")),1)]),_:1}),f(E,{onClick:Ge,class:"remove-btn"},{default:i(()=>[B(c(a.$t("remove")),1)]),_:1})])),O.value?(l(),p(te,{key:2})):b("",!0)])}}}),Ua=be(Ta,[["__scopeId","data-v-688d3389"]]),Ga={class:"catalogs-wrap g-flex"},La={class:"catalog-list-left"},Oa={class:"catalog-header"},Aa={key:0,class:"catalog-list"},Ba=["onClick"],Fa={class:"catalog-detail"},Z="new catalog",Da=he({__name:"index",setup(se){const{t:H}=ve(),N=We(),Y=ye(),y=P([]),m=P({}),M=L(!1),$=L(!1),x=fe.PRESENTED_IMAGE_SIMPLE;async function u(){try{$.value=!0;const g=await Qe();y.length=0,(g||[]).forEach(C=>{y.push({catalogName:C.catalogName,catalogType:C.catalogType})})}finally{$.value=!1}}function j(){var R,w;const{catalogname:g="",type:C}=Y.query,_={};if(decodeURIComponent(g)===Z){D();return}g?(_.catalogName=g,_.catalogType=C):(_.catalogName=(R=y[0])==null?void 0:R.catalogName,_.catalogType=(w=y[0])==null?void 0:w.catalogType),U(_)}function I(g){M.value?h(()=>{U(g),M.value=!1,O(!1)}):U(g)}async function U(g){const{catalogName:C,catalogType:_}=g;m.catalogName=C||"",m.catalogType=_||"",await N.replace({path:"/catalogs",query:{catalogname:encodeURIComponent(m.catalogName),type:m.catalogType}})}async function O(g,C){var R,w,e,V;M.value=g,C&&(await F(),C!=null&&C.catalogName||(C.catalogName=(R=y[0])==null?void 0:R.catalogName,C.catalogType=(w=y[0])==null?void 0:w.catalogType));const _=y.findIndex(z=>z.catalogName===Z);if(_>-1){y.splice(_);const z={catalogName:(e=y[0])==null?void 0:e.catalogName,catalogType:(V=y[0])==null?void 0:V.catalogType};U(z);return}C&&U(C)}async function F(){await u()}function D(){M.value?h(()=>{q()}):q()}async function q(){const g={catalogName:Z,catalogType:""};await U(g),y.push(g),M.value=!0}Ce(async()=>{await u(),j()});function h(g){oe.confirm({title:H("leavePageModalTitle"),content:H("leavePageModalContent"),okText:H("leave"),onOk:async()=>{g&&await g()}})}return Ze((g,C,_)=>{M.value?h(()=>{_()}):_()}),(g,C)=>{const _=_e,R=fe;return l(),d("div",Ga,[T("div",La,[T("div",Oa,c(`${g.$t("catalog")} ${g.$t("list")}`),1),y.length&&!$.value?(l(),d("ul",Aa,[(l(!0),d(J,null,Q(y,w=>(l(),d("li",{key:w.catalogName,class:le(["catalog-item g-text-nowrap",{active:w.catalogName===m.catalogName}]),onClick:e=>I(w)},c(w.catalogName),11,Ba))),128))])):b("",!0),f(_,{onClick:D,disabled:m.catalogName===Z,class:"add-btn"},{default:i(()=>[B("+")]),_:1},8,["disabled"])]),T("div",Fa,[!y.length&&!$.value?(l(),p(R,{key:0,image:Je(x),class:"detail-empty"},null,8,["image"])):(l(),p(Ua,{key:1,isEdit:M.value,onUpdateEdit:O,onUpdateCatalogs:F},null,8,["isEdit"]))])])}}}),Ya=be(Da,[["__scopeId","data-v-ee0cc5a1"]]);export{Ya as default};
