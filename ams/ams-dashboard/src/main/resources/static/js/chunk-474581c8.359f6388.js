(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-474581c8"],{"218f":function(e,t,a){"use strict";a("38b4")},3471:function(e,t,a){"use strict";a("5431")},"38b4":function(e,t,a){},5431:function(e,t,a){},5738:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return n})),a.d(t,"h",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return r})),a.d(t,"e",(function(){return i})),a.d(t,"i",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return b}));var c=a("b32d");function l(){return c["a"].get("ams/v1/catalogs")}function n(e){return c["a"].get(`ams/v1/catalogs/${e}/databases`)}function o(e){const{catalog:t,db:a}=e;return c["a"].get(`ams/v1/catalogs/${t}/databases/${a}/tables`)}function s({catalog:e="",db:t="",table:a=""}){return c["a"].get(`ams/v1/tables/catalogs/${e}/dbs/${t}/tables/${a}/details`)}function r(e){const{catalog:t,db:a,table:l,page:n,pageSize:o}=e;return c["a"].get(`ams/v1/tables/catalogs/${t}/dbs/${a}/tables/${l}/partitions`,{params:{page:n,pageSize:o}})}function i(e){const{catalog:t,db:a,table:l,partition:n,page:o,pageSize:s}=e;return c["a"].get(`ams/v1/tables/catalogs/${t}/dbs/${a}/tables/${l}/partitions/${n}/files`,{params:{page:o,pageSize:s}})}function u(e){const{catalog:t,db:a,table:l,page:n,pageSize:o}=e;return c["a"].get(`ams/v1/tables/catalogs/${t}/dbs/${a}/tables/${l}/transactions`,{params:{page:n,pageSize:o}})}function d(e){const{catalog:t,db:a,table:l,transactionId:n,page:o,pageSize:s}=e;return c["a"].get(`ams/v1/tables/catalogs/${t}/dbs/${a}/tables/${l}/transactions/${n}/detail`,{params:{page:o,pageSize:s}})}function b(e){const{catalog:t,db:a,table:l,page:n,pageSize:o}=e;return c["a"].get(`ams/v1/tables/catalogs/${t}/dbs/${a}/tables/${l}/optimize`,{params:{page:n,pageSize:o}})}},8552:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var c=a("7a23"),l=a("47e2");function n(){const{t:e}=Object(l["b"])(),t=Object(c["computed"])(()=>e("catalog")).value,a=Object(c["computed"])(()=>e("databaseName")).value,n=Object(c["computed"])(()=>e("tableName")).value,o=Object(c["computed"])(()=>e("optimzerGroup")).value,s=Object(c["computed"])(()=>e("resourceGroup")).value,r=Object(c["computed"])(()=>e("parallelism")).value,i=Object(c["computed"])(()=>e("username")).value,u=Object(c["computed"])(()=>e("password")).value,d=Object(c["computed"])(()=>e("database",2)).value,b=Object(c["computed"])(()=>e("table",2)).value;return{selectClPh:e("selectPlaceholder",{selectPh:t}),selectDBPh:e("selectPlaceholder",{selectPh:a}),inputDBPh:e("inputPlaceholder",{inputPh:a}),inputClPh:e("inputPlaceholder",{inputPh:t}),inputTNPh:e("inputPlaceholder",{inputPh:n}),selectOptGroupPh:e("inputPlaceholder",{inputPh:o}),resourceGroupPh:e("inputPlaceholder",{inputPh:s}),parallelismPh:e("inputPlaceholder",{inputPh:r}),usernamePh:e("inputPlaceholder",{inputPh:i}),passwordPh:e("inputPlaceholder",{inputPh:u}),filterDBPh:e("filterPlaceholder",{inputPh:d}),filterTablePh:e("filterPlaceholder",{inputPh:b})}}},bcdf:function(e,t,a){"use strict";a("d5c0")},d28b:function(e,t,a){},d323:function(e,t,a){"use strict";a.r(t);var c=a("7a23");const l={class:"console-wrap"},n={class:"sql-wrap"},o={class:"sql-block"},s={class:"top-ops g-flex-jsb"},r={class:"title-left g-flex-ac"},i={class:"select-catalog g-mr-12"},u={class:"label"},d={class:"title-right"},b={class:"sql-content"},O={class:"sql-raw"},m={class:"g-ml-12"},p={class:"sql-shortcuts"},j={class:"shortcuts"},v={class:"tab-operation"},f={class:"tab"},g=["onClick"],h={class:"debug-result"};function k(e,t,a,k,y,C){const B=Object(c["resolveComponent"])("a-select"),N=Object(c["resolveComponent"])("svg-icon"),V=Object(c["resolveComponent"])("a-tooltip"),S=Object(c["resolveComponent"])("sql-editor"),E=Object(c["resolveComponent"])("loading-outlined"),w=Object(c["resolveComponent"])("close-circle-outlined"),q=Object(c["resolveComponent"])("check-circle-outlined"),P=Object(c["resolveComponent"])("a-button"),$=Object(c["resolveComponent"])("sql-log"),x=Object(c["resolveComponent"])("sql-result"),z=Object(c["resolveComponent"])("u-loading");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",l,[Object(c["createElementVNode"])("div",{class:Object(c["normalizeClass"])(["console-content",{fullscreen:e.fullscreen}])},[Object(c["createElementVNode"])("div",n,[Object(c["createElementVNode"])("div",o,[Object(c["createElementVNode"])("div",s,[Object(c["createElementVNode"])("div",r,[Object(c["createElementVNode"])("div",i,[Object(c["createElementVNode"])("span",u,Object(c["toDisplayString"])(e.$t("use")),1),Object(c["createVNode"])(B,{value:e.curCatalog,"onUpdate:value":t[0]||(t[0]=t=>e.curCatalog=t),style:{width:"200px"},options:e.catalogOptions},null,8,["value","options"])]),"Running"===e.runStatus?(Object(c["openBlock"])(),Object(c["createBlock"])(V,{key:0,title:e.$t("pause"),placement:"bottom"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(N,{className:"icon-svg","icon-class":"sqlpause",onClick:t[1]||(t[1]=t=>e.handleIconClick("pause")),class:"g-mr-12",disabled:e.readOnly},null,8,["disabled"])]),_:1},8,["title"])):(Object(c["openBlock"])(),Object(c["createBlock"])(V,{key:1,title:e.$t("run"),placement:"bottom"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(N,{className:"icon-svg","icon-class":"sqldebug",onClick:t[2]||(t[2]=t=>e.handleIconClick("debug")),class:"g-mr-12",disabled:e.readOnly},null,8,["disabled"])]),_:1},8,["title"])),Object(c["createVNode"])(V,{title:e.$t("format"),placement:"bottom"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(N,{className:"icon-svg",isStroke:!0,"icon-class":"format",onClick:t[3]||(t[3]=t=>e.handleIconClick("format")),disabled:e.readOnly},null,8,["disabled"])]),_:1},8,["title"])]),Object(c["createElementVNode"])("div",d,[Object(c["createVNode"])(V,{title:e.fullscreen?e.$t("recovery"):e.$t("fullscreen"),placement:"bottom",getPopupContainer:e.getPopupContainer},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(N,{className:"icon-svg",isStroke:!0,"icon-class":e.fullscreen?"sqlinit":"sqlmax",onClick:e.handleFull,disabled:!1,class:"g-ml-12"},null,8,["icon-class","onClick"])]),_:1},8,["title","getPopupContainer"])])]),Object(c["createElementVNode"])("div",b,[Object(c["createElementVNode"])("div",O,[Object(c["createVNode"])(S,{ref:"sqlEditorRef",sqlValue:e.sqlSource,value:e.sqlSource,"onUpdate:value":t[4]||(t[4]=t=>e.sqlSource=t),readOnly:e.readOnly,options:{readOnly:e.readOnly,minimap:{enabled:!1}}},null,8,["sqlValue","value","readOnly","options"])]),e.runStatus?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:0,class:"run-status",style:Object(c["normalizeStyle"])({background:e.bgcMap[e.runStatus]})},["Running"===e.runStatus?(Object(c["openBlock"])(),Object(c["createBlock"])(E,{key:0,style:{color:"#1890ff"}})):Object(c["createCommentVNode"])("",!0),"Canceled"===e.runStatus||"Failed"===e.runStatus?(Object(c["openBlock"])(),Object(c["createBlock"])(w,{key:1,style:{color:"#ff4d4f"}})):Object(c["createCommentVNode"])("",!0),"Finished"===e.runStatus?(Object(c["openBlock"])(),Object(c["createBlock"])(q,{key:2,style:{color:"#52c41a"}})):Object(c["createCommentVNode"])("",!0),"Created"===e.runStatus?(Object(c["openBlock"])(),Object(c["createBlock"])(w,{key:3,style:{color:"#333"}})):Object(c["createCommentVNode"])("",!0),Object(c["createElementVNode"])("span",m,Object(c["toDisplayString"])(e.$t(e.runStatus)),1)],4)):Object(c["createCommentVNode"])("",!0)])]),Object(c["createElementVNode"])("div",p,[Object(c["createElementVNode"])("div",j,Object(c["toDisplayString"])(e.$t("sqlShortcuts")),1),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.shortcuts,t=>(Object(c["openBlock"])(),Object(c["createBlock"])(P,{key:t,type:"link",disabled:"Running"===e.runStatus,onClick:a=>e.generateCode(t),class:"code"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(t),1)]),_:2},1032,["disabled","onClick"]))),128))])]),Object(c["withDirectives"])(Object(c["createElementVNode"])("div",{class:Object(c["normalizeClass"])(["sql-result",e.resultFullscreen?"result-full":""])},[Object(c["createElementVNode"])("div",v,[Object(c["createElementVNode"])("div",f,[Object(c["createElementVNode"])("span",{class:Object(c["normalizeClass"])([{active:"log"===e.operationActive},"tab-item"]),onClick:t[5]||(t[5]=t=>e.operationActive="log")},Object(c["toDisplayString"])(e.$t("log")),3),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.resultTabList,t=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",{key:t.id,class:Object(c["normalizeClass"])([{active:e.operationActive===t.id},"tab-item"]),onClick:a=>e.operationActive=t.id},Object(c["toDisplayString"])(t.id),11,g))),128))])]),Object(c["createElementVNode"])("div",h,[Object(c["withDirectives"])(Object(c["createVNode"])($,{ref:"sqlLogRef"},null,512),[[c["vShow"],"log"===e.operationActive]]),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.resultTabList,t=>(Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:t.id},[e.operationActive===t.id?(Object(c["openBlock"])(),Object(c["createBlock"])(x,{key:0,info:t},null,8,["info"])):Object(c["createCommentVNode"])("",!0)],64))),128))])],2),[[c["vShow"],e.showDebug]])],2),e.loading?(Object(c["openBlock"])(),Object(c["createBlock"])(z,{key:0})):Object(c["createCommentVNode"])("",!0)])}a("3b18");var y=a("f64c"),C=a("c2c6");const B={theme:"arcticSql",language:"sql",fontSize:12,lineHeight:24,fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, source-code-pro, monospace',folding:!0,suggestLineHeight:20,autoIndent:!0,renderLineHighlight:"all",scrollBeyondLastLine:!1,contextmenu:!1,readOnly:!0,fixedOverflowWidgets:!0},N=Object.assign({},B,{theme:"arcticSql",language:"sql",readOnly:!1,lineHeight:24,fontSize:12,fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, source-code-pro, monospace',lineNumbersMinChars:3,wordWrap:"on",renderLineHighlight:"all",minimap:{enabled:!1},contextmenu:!1,automaticLayout:!0,scrollBeyondLastLine:!1});var V=Object(c["defineComponent"])({__name:"index",props:{sqlValue:null,options:null,readOnly:{type:Boolean}},emits:["save","update:value","change"],setup(e,{expose:t,emit:a}){const l=e;let n,o="";const s={};function r(){n&&n.layout()}function i(){if(n){const e=n.addCommand(C["KeyMod"].CtrlCmd|C["KeyCode"].KEY_S,()=>{a("save")});s.save=e;const t=n.addCommand(C["KeyMod"].Alt|C["KeyMod"].Shift|C["KeyCode"].KEY_F,()=>{u()});s.format=t}}function u(){const e=n&&n.getAction("editor.action.formatDocument");e&&e.run()}return Object(c["watch"])(()=>l.sqlValue,e=>{e&&o!==e&&n&&n.setValue(e)}),window.addEventListener("resize",r),t({executeCommand(e){const t=s[e],a=n;t&&a&&a._commandService.executeCommand(t)},updateOptions(e={}){n&&n.updateOptions(e)}}),Object(c["onBeforeUnmount"])(()=>{window.removeEventListener("resize",r),n&&n.dispose()}),Object(c["onMounted"])(()=>{const e=document.getElementsByClassName("m-sql-editor")[0];Object(c["nextTick"])(()=>{const t=n=C["editor"].create(e,{...N,...l.options});i(),t.setValue(l.sqlValue||""),t.onDidChangeModelContent(e=>{const t=n.getValue();a("update:value",t),a("change",t),o=t})})}),(t,a)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{class:Object(c["normalizeClass"])(["m-sql-editor",{disabled:e.readOnly}]),style:{height:"100%",width:"100%"}},null,2))}}),S=(a("fea2"),a("d959")),E=a.n(S);const w=E()(V,[["__scopeId","data-v-13c652ee"]]);var q,P=w;(function(e){e["Created"]="#f5f5f5",e["Failed"]="#fff2f0",e["Finished"]="#f6ffed",e["Canceled"]="#f5f5f5"})(q||(q={}));var $=a("8fe6"),x=a("411c"),z=a("d34f");const L={class:"sql-result-wrap"},F={class:"g-ml-8"},D={key:0,class:"empty"},_={key:1,class:"result-wrap"},M={class:"ant-table sql-result-table",style:{width:"100%"}},R={class:"ant-table-thead"},I={class:"ant-table-tbody"};var T=Object(c["defineComponent"])({__name:"sql-result",props:{info:null},setup(e){const t=e,a=Object(c["computed"])(()=>{var e;return!t.info||!(null!==(e=t.info)&&void 0!==e&&e.columns)}),l=Object(c["computed"])(()=>{var e;return null===(e=t.info)||void 0===e?void 0:e.status});return(e,n)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",L,[Object(c["createElementVNode"])("div",{class:"result-status",style:Object(c["normalizeStyle"])({background:Object(c["unref"])(q)[Object(c["unref"])(l)]})},["Running"===Object(c["unref"])(l)?(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])($["a"]),{key:0,style:{color:"#1890ff"}})):Object(c["createCommentVNode"])("",!0),"Canceled"===Object(c["unref"])(l)||"Failed"===Object(c["unref"])(l)?(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(x["a"]),{key:1,style:{color:"#ff4d4f"}})):Object(c["createCommentVNode"])("",!0),"Finished"===Object(c["unref"])(l)?(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(z["a"]),{key:2,style:{color:"#52c41a"}})):Object(c["createCommentVNode"])("",!0),"Created"===Object(c["unref"])(l)?(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(x["a"]),{key:3,style:{color:"#333"}})):Object(c["createCommentVNode"])("",!0),Object(c["createElementVNode"])("span",F,Object(c["toDisplayString"])(Object(c["unref"])(l)),1)],4),Object(c["unref"])(a)?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",D,Object(c["toDisplayString"])(e.$t("noResult")),1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",_,[Object(c["createElementVNode"])("table",M,[Object(c["createElementVNode"])("thead",R,[Object(c["createElementVNode"])("tr",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.info.columns,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("th",{key:e},Object(c["toDisplayString"])(e),1))),128))])]),Object(c["createElementVNode"])("tbody",I,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.info.rowData,(e,a)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:a+1},[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e,(e,l)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("td",{key:a+e+l},[Object(c["createElementVNode"])("span",{class:"td-val",style:Object(c["normalizeStyle"])({maxWidth:100/t.info.columns.length+"%"})},Object(c["toDisplayString"])(e),5)]))),128))]))),128))])])]))]))}});a("bcdf");const A=E()(T,[["__scopeId","data-v-7c2684ac"]]);var H=A;const K={class:"sql-log"},U=["innerHTML"];var G=Object(c["defineComponent"])({__name:"sql-log",setup(e,{expose:t}){const a=Object(c["ref"])("");return t({initData(e){a.value=e}}),(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",K,[Object(c["createElementVNode"])("div",{innerHTML:a.value,style:{"white-space":"pre-line","font-size":"12px"}},null,8,U)]))}});a("218f");const W=E()(G,[["__scopeId","data-v-b3aeee8e"]]);var J=W,Y=a("b32d");function Q(e){return Y["a"].get(`ams/v1/terminal/${e}/result`)}function X(){return Y["a"].get("ams/v1/terminal/examples")}function Z(e){return Y["a"].get("ams/v1/terminal/examples/"+e)}function ee(e){const{catalog:t,sql:a}=e;return Y["a"].post(`ams/v1/terminal/catalogs/${t}/execute`,{sql:a})}function te(e){return Y["a"].put(`ams/v1/terminal/${e}/stop`)}function ae(e){return Y["a"].get(`ams/v1/terminal/${e}/logs`)}function ce(){return Y["a"].get("ams/v1/terminal/latestInfos")}var le=a("5738"),ne=a("8552"),oe=Object(c["defineComponent"])({name:"Terminal",components:{SqlEditor:P,SqlResult:H,SqlLog:J,CheckCircleOutlined:z["a"],CloseCircleOutlined:x["a"],LoadingOutlined:$["a"]},setup(){const e=Object(c["reactive"])(Object(ne["a"])()),t=Object(c["ref"])(!1),a=Object(c["ref"])(null),l=Object(c["ref"])(null),n=Object(c["ref"])(!1),o=Object(c["ref"])(""),s=Object(c["ref"])(!1),r=Object(c["ref"])(""),i=Object(c["ref"])(),u=Object(c["ref"])(!1),d=Object(c["ref"])(!1),b=Object(c["ref"])("log"),O=Object(c["reactive"])([]),m=Object(c["reactive"])([]),p=Object(c["ref"])(""),j=Object(c["ref"])(),v=Object(c["reactive"])([]),f=Object(c["shallowReactive"])(q);Object(c["watch"])(()=>n,()=>{a.value.updateOptions({readOnly:n})});const g=e=>{"debug"!==e?"format"!==e?"pause"===e&&S():a.value&&a.value.executeCommand("format"):V()},h=async()=>{const e=await Object(le["a"])();(e||[]).forEach(e=>{O.push({value:e.catalogName,label:e.catalogName})}),O.length&&(p.value=O[0].value)},k=async()=>{const e=await X();m.push(...e||[])},C=()=>{u.value=!u.value},B=()=>{d.value=!d.value},N=()=>{v.length=0,l.value.initData("")},V=async()=>{try{if(!p.value)return void y["a"].error(e.selectClPh);s.value=!0,N(),r.value="Running";const t=await ee({catalog:p.value,sql:o.value});i.value=t.sessionId||0,w()}catch(t){r.value="Failed",y["a"].error(t.message||"error")}},S=async()=>{if(i.value)try{r.value="Canceled",await te(i.value)}catch(e){r.value="Failed"}},E=async()=>{try{v.length=0;const e=await Q(i.value||0);e&&e.length&&v.push(...e)}catch(e){}},w=async()=>{if("Running"===r.value&&i.value){const e=await ae(i.value);if(b.value="log",!e)return;const{logStatus:t,logs:a}=e;null!==a&&void 0!==a&&a.length&&l.value.initData(a.join("\n")),r.value=t,E(),"Finished"===t||"Canceled"===t?clearTimeout(j.value):j.value=setTimeout(()=>{w()},1500)}},P=async e=>{try{if("Running"===r.value)return;clearTimeout(j.value),t.value=!0;const a=await Z(e);o.value=a,s.value=!1,r.value="",N()}catch(a){y["a"].error(a.message)}finally{t.value=!1}},$=()=>document.body,x=async()=>{try{a.value&&(o.value=""),t.value=!0;const e=await ce();i.value=e.sessionId,e.sessionId>0&&(a.value&&(o.value=e.sql||""),r.value="Running",s.value=!0,w())}catch(e){y["a"].error(e.message)}finally{t.value=!1}};return Object(c["onBeforeUnmount"])(()=>{clearTimeout(j.value)}),Object(c["onMounted"])(()=>{x(),k(),h()}),{loading:t,bgcMap:f,sqlLogRef:l,sqlEditorRef:a,fullscreen:u,resultFullscreen:d,operationActive:b,resultTabList:v,runStatus:r,shortcuts:m,curCatalog:p,catalogOptions:O,handleIconClick:g,handleFull:C,resultFull:B,showDebug:s,sqlSource:o,readOnly:n,generateCode:P,getPopupContainer:$}}});a("3471");const se=E()(oe,[["render",k],["__scopeId","data-v-bed05f50"]]);t["default"]=se},d5c0:function(e,t,a){},fea2:function(e,t,a){"use strict";a("d28b")}}]);